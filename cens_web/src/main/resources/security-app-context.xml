
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
                    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
                    http://www.springframework.org/schema/security 
                    http://www.springframework.org/schema/security/spring-security-3.1.xsd">

	<http auto-config="true" access-denied-page="/accesodenegado">
		<intercept-url pattern="/inicializar/**" access="ROLE_ANONYMOUS"  />
		<intercept-url pattern="/login/**" access="ROLE_ANONYMOUS"  />
		<intercept-url pattern="/loginfailed/**" access="ROLE_ANONYMOUS"  />
		<intercept-url pattern="/css/midasUI-theme/images/**" access="ROLE_ANONYMOUS, ROLE_ADMINISTRADOR,ROLE_ASESOR, ROLE_RRHH, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/adjuntos/**" access="ROLE_ANONYMOUS, ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_RRHH, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />

		
		<intercept-url pattern="/usuarios" access="ROLE_ADMINISTRADOR, ROLE_ASESOR"  />
		<intercept-url pattern="/usuario/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR"  />
		<intercept-url pattern="/usuariosgrilla**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR"  />
		<intercept-url pattern="/removeusuario**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR"  />
		
		<intercept-url pattern="/empleado" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_RRHH, ROLE_ADMINISTRACION"  />

		<intercept-url pattern="/cliente" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/cliente/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		
		<intercept-url pattern="/clientes/beneficios" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/clientes/beneficiosgrilla**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/clientes/removebeneficiocliente**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/clientes/beneficios/changeestado**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />
		<intercept-url pattern="/clientes/beneficio/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION"  />


		<intercept-url pattern="/operacion/informemensual/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_ADMINISTRACION, ROLE_GTEOPERACION, ROLE_JEFEOPERACION" />
		<intercept-url pattern="/operacion/informemensualexceldata/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_ADMINISTRACION, ROLE_GTEOPERACION, ROLE_JEFEOPERACION" />
		<intercept-url pattern="/operacion/informemensualexcelexport**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_ADMINISTRACION, ROLE_GTEOPERACION, ROLE_JEFEOPERACION" />
		
		<intercept-url pattern="/operacion/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_GTEOPERACION, ROLE_JEFEOPERACION"  />
		<intercept-url pattern="/administracion/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_ADMINISTRACION"  />
								
		 
		<intercept-url pattern="/**" access="ROLE_ADMINISTRADOR, ROLE_ASESOR, ROLE_RRHH, ROLE_GTEOPERACION, ROLE_JEFEOPERACION, ROLE_ADMINISTRACION" />

		
		<form-login 
			login-page="/login" 
			default-target-url="/mvc/main"
			authentication-failure-url="/loginfailed" />
		 <logout logout-success-url="/login" />
		
	</http>


	<authentication-manager>
		<authentication-provider>
<!-- 			<password-encoder hash="md5"></password-encoder> -->
			<jdbc-user-service data-source-ref="dataSource"

				users-by-username-query="
		      	select username,password, enabled 
		      	from cens_usuarios where username=?"

				authorities-by-username-query="
			  	select u.username as username, pusc.perfilType as authority from  
				cens_usuarios u inner join cens_perfil_usuario_cens pusc on u.id = pusc.usuario_id				
				where u.username =? " />

		</authentication-provider>
	</authentication-manager>

</beans:beans>
